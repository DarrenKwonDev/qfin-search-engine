# Self-Evolving Research Agent

## 목적
arXiv에서 사용자의 한줄 입력을 해석해 q-fin 논문을 찾고, 핵심 내용을 구조화 요약해 사용자의 질문을 빠르게 이해/탐색할 수 있도록 한다. 사용 기록이 누적될수록 추천 정확도와 검색 효율이 개선되는 개인화 추천 시스템을 목표로 한다.

## 현재 범위(Phase 1)
- 목표는 "질문에 맞는 논문 탐색 + 이해를 위한 구조화 요약"까지로 한정한다.
- 창발적인 매매 아이디어 도출, 전략 설계, 백테스팅 자동화는 현재 범위에서 제외한다.
- 실제 트레이딩 시스템 구현/수정/테스트는 사용자 책임이며, 본 프로젝트는 이를 자동 실행하지 않는다.
- 향후 필요 시, Research Card/Human Gate 기반으로 가설 검증 단계(Phase 2)를 별도 통합한다.

## 사용 방식
- opencode의 command/subcommand 기반 인터페이스만 지원한다.
- 모든 입력은 command로 들어오며 subcommand로 세부 의도를 구분한다.
- 내부 파이프라인은 command 종류와 무관하게 동일하게 동작한다.

## 기대 동작
- 한줄 입력을 받아 의도를 분류하고 핵심 키워드/유사어 확장을 생성한다.
- arXiv 공식 API를 사용해 q-fin 논문 후보를 수집하고 적합도를 평가한다.
- 논문을 읽고 요약본을 생성한다.
- 요약본은 사용자의 질문 해결과 논문 이해를 돕는 구조를 갖춘다.
- 반복 사용 시, 대화 기반 피드백을 축적해 랭킹과 키워드 가중치를 개선한다.

## 입력 처리
- LLM 기반 의도 분류: 입문/연구질문/개념탐색/기타
- 핵심 키워드 추출 및 유사어 확장(사전 없이 LLM이 생성)
- 입문 요청은 survey/review/tutorial 키워드에 높은 가중치 부여

## 요약본 포맷(LLM 전달용)
- 논문 메타
  - 제목, 저자, arXiv ID, 공개일
- 문제 정의 및 배경
- 핵심 가설/아이디어
- 데이터
  - 데이터 소스, 기간, 샘플 구성, 피처
- 방법론
  - 모델/알고리즘, 학습/검증 절차, 하이퍼파라미터
- 실험/결과
  - 주요 지표, 비교 기준, 성능 요약
- 재현성
  - 코드/데이터 공개 여부, 구현 난이도, 필요한 의존성
- 한계 및 실패 사례
- 확장 아이디어

## 요약 생성 정책
- 요약은 한국어로 작성하되, 핵심 키워드는 원문 용어를 괄호로 병기할 수 있다.
- PDF가 없을 때는 abstract 기반 요약이며, 그 사실을 명시한다.
- 논문당 summary.md 1개만 생성한다.

## 아키텍처 방식
- 입력 해석: 한줄 입력을 의도/키워드/유사어 확장으로 변환한다.
- 후보 수집: arXiv 공식 API(ATOMPUB)로 q-fin 메타를 수집하고 중복을 제거한다.
- 선별/랭킹: 키워드 적합도, 카테고리, abstract 길이를 기준으로 평가한다.
- 최소 적합 기준: q-fin 카테고리, 핵심 키워드 1개 이상 매칭, abstract 최소 길이
- 결과 제한: 최대 3편을 반환하되 적합 후보가 적으면 더 적게 반환한다.
- 본문 처리: PDF/본문 텍스트를 추출해 섹션별로 분리한다.
- 구조화 요약: 요약본 포맷에 맞춰 질문 해결과 논문 이해에 필요한 정보로 정리한다.
- 피드백 루프: 대화에서 핵심 문장만 추출해 유용성 점수를 산정하고 저장한다.

## 저장 정책
- 논문 메타와 링크는 항상 저장한다.
- PDF는 가능할 때만 저장한다.
- 저장 구조(예시)
  - data/papers/{arxiv_id}/meta.json
  - data/papers/{arxiv_id}/paper.pdf
  - data/papers/{arxiv_id}/summary.md

## 피드백 저장
- 대화 전체가 아니라 논문 관련 핵심 문장만 발췌해 저장한다.
- 저장 항목(예시)
  - query, paper_id, conversation_excerpt, utility_score, confidence, rationale, timestamp

## 점진적 개선 방향
- 최근 10개 질문을 기준으로 가중치를 업데이트해 최신 선호를 반영한다.
- 선택/비선택과 대화 기반 유용성 점수를 랭킹에 반영한다.
- 유사 입력 재등장 시, 과거 우수 결과를 우선 노출한다.

## 가중치 업데이트 규칙
- 최신 10개 질문을 기준으로 질문 카운트 기반 최신 가중치를 적용한다.
- 이벤트 가중치: w_event = exp(-(N - i) / tau_q), tau_q = 10
- 업데이트: delta = (utility_score - 0.5) * 2, Δweight = lr * w_event * delta
- 기본값: lr = 0.05, 가중치 범위는 [-1, 1]로 클램프

## 다음 작업
- arXiv API 쿼리 템플릿 및 필드 정규화
- 의도 분류/유사어 확장 프롬프트 설계
- 요약 템플릿 샘플 생성 및 품질 점검
- Phase 2(가설 검증/백테스팅 연계)는 현재 범위 밖으로 유지하고 별도 설계 문서로 관리
